<html><head><title>CHANGELOG</title></head><body><!-- (jEdit options) :folding=explicit:collapseFolds=1: --><pre>
==============================================================================
===  TO DO  ==================================================================
==============================================================================
{{{ Other people's bugs
    Weird intra-sidechain clashes for 1BKR (low occ atoms in-chain)
    Prekin: All balls are marked alt B (even those for alt A)
    Changes still made by Reduce -nobuild:
        Existing protonation state for His
        Existing Met CH3 and Lys NH3 orientation (don't want -norotnh3 and -norotmet)
    Probe: -NOVDWout switch missing from docs, duplicated ONLYBADOUT
    Prekin: doesn't mark pointmasters on the start of vectors (those flagged P)
    Reduce -nobuild: wrong protonation for 1gca His 152
        Wrong placement for het O3 H wrt R141 and D215 in 2DRI
    NOEs thicker, esp. violations
    Color by OCC/B still leaves SS as yellow (Prekin bug?)
    Prekin: dangling altB C--N for 1NBX B 29 (whenever i has all A and B alts)
    Prekin: unwanted @listcolordominant for multi-subunit ribbons
    IE6: doesn't display transparent PNGs correctly (gray background)
    IE6: hitting enter submits form without a cmd=[button name], breaks upload
}}}
{{{ Ideas, long-term goals, etc.
    User manual (do we need this in addition to page-by-page help?)
        Tutorial / walk-thru
        Write a decent document about installation of MolProbity for web and script use
        Update Java install docs for end users; note on KiNG page
    Could make it a web service with XML-RPC (SOAP, CORBA too complex)
    Download ZIP archives of session files
        Allow "hidden" user files; default download doesn't include these?
    Retrieve maps from the EDS
    Multicrit: views for trouble spots sorted by severity (also hypertext?)
    Estimate time for e.g. analysis jobs?
    Cache commonly run (or all) standard PDB queries?
    Cache feedback emails in MySQL database as well as filesystem?
    Add "priviledged" users who can e.g. run extra NMR models
    Allow uploads of tarballs of NMR models?
    On upload of alt conf model, do table to choose which ones to use
    "nice" large jobs such as multi-model NMR runs
    Allow simple comparison of bad residues in two models; see jobs/aacgeom.php
    Add documentation to the analysis results page (how to interpret)
    Add explanation of SSWING, Reduce, AAC, kins on setup pages
    Make sure Reduce doesn't shrink the PDB file (lost atoms/models, etc)
    Add coloring type drop box for -lots kins
    Write command line scripts for common actions; remove junk from cmdline/
    Produce multi-model multicrit kinemages from the GUI
    Give NMR models a linking ID somehow
    How to handle multi-model Ramachandran plots when models are split out?
    Verb-centered (sitemap) vs. noun-centered (PDB "stable") interface
    The "0+3" concept: single model, chain-chain (interface), overlapped pairs
        (NCS, etc), large ensembles (NMR/MD)
    Support "permevents" for notebook pages - eval() or just a pageCall() target
        Why did I want this? Redirect to action pages, maybe?
    analyze::findAltConfs() should also support nuc. acid mc/sc classification
    re-assort the functions from visualize.php and analyze.php
}}}
    Develop "helper" pages; mark optional steps clearly
    Pick lowest resolution number mentioned in file; allow override?
    Biol. units use MODELs rather than chain IDs? Check and then email P. Bourne
    DANG is included in bin/ but we don't *use* it anywhere... / upgrade to 1.9
    SEP(Gary): LIST of interacting (residues|*ATOMS*) across an interface
    Oneline, all-in-one (kins, etc) for JCSG
    "outlier" column for multichart
    Move labbook.html to charts/ ?
    for welcome: more icons, clean out old unused images
    Implement download-as-ZIP for "popular downloads" section
    When NMR files are split, notebook assoc'd with first model only
    Warn users using MSIE, suggest Firefox?
    JavaScript warning on bad events "Don't use Back button"
    
==============================================================================
===  CHANGE LOG  =============================================================
==============================================================================

### 3beta18 ###
- changing the REFRESH tags fixes MP3 to work with IE6 ... mostly ;)
  See "Other people's bugs", above.
- started logging the user-agent (browser identification) strings on sess start
- added browser detection code from the web
- improved usage_history.php, added browser usage statistics
- added human-readable error messages to upload error pages;
  modified welcome.php's upload form to work even when cmd is not set.

### 3beta17 ###
- started on new welcome "all in wonder" page
- changed $delegate declarations before classes to be done dynamically from
  within index.php as $delg_class = basename(...); $delegate = new $delg_class;
  This required renaming all the classes in pages/ and updating devel docs.
- continued development of new welcome page including working model selector
  with JavaScript autosubmit and list of tools with pretty new icons.
- moved global var to class var for file_browser.php
- improved formatting on welcome page; still needs work
- added file downloads and lab notebook entries to welcome page for curr model
- added "primaryDownloads" list per model
- added "has_most_H" field to PDB-stat results
- merged welcome pages back together into one
- cleaned up site map to be more bare-bones again
- misc improvements to welcome page code
- added debugging page that displays $_SESSION, linked from admin pages
- added icons for making kinemages and interface contacts
- verified that IE 6.x doesn't work with MP3 at all, presumably due to weird
  caching behavior -- e.g. uploads just leave the user at the Welcome page.
- added anti-caching header() calls to mpInitEnvirons() to combat IE6 bug.
- not a page-caching issue. It looks like the background job never gets started,
  because the system/errors file is never even created.
- actually, the session ID doesn't get preserved during background job
  processing -- IE doesn't like index.php?SESSION_ID... in the REFRESH tag.
- added URL=... to all REFRESH tags. Google says this should fix the IE bug.
- commented anti-caching commands out again. If it ain't broke...

### 3beta16 ###
- fixed bug in logout_destroy.php that kept the session ID out of the log file
- added sorting and "no sessions" msg to show_sessions.php
- changed config.php and core.php to auto-detect server timezone (usually?)
- added page for monitoring usage history based on molprobity.log
- added links between the various admin/ scripts
- housecleaning in check_config.php for more sensible order
- added much more detail for 'aacgeom' log messages
- upgraded Prekin to do -pperptobase to -pperptoline change for Laura
- made link to "alpha test" more visible on kinemage
- usage history now has selectable columns for detailed breakdown
- added "clashes-with" information to clashlist parser and multichart
- moved most HTML formatting for multichart in lib/sortable_table.php
- created multichart snapshot in charts/, main data in raw_data/ -- is this OK?
- rebuilt glass with Michael as the new alpha-test host of MolProbity3

### 3beta15 ###
- clash stats for score B lt 40 are now done correctly rather than against the
  raw clashscore, which was producing an unfair negative bias for all structures
- made explanation of percentile rank more upbeat: "100 is best...; 0 is worst"
- experimental: gzip large multikins (see core.php, analyze.php in lib/)
- file browser: links for .kin.gz, .gz, .tgz, .zip, .html
- core.php now turns off E_NOTICE, which should save reconfiguring newer PHPs.
- cleaned up multikin gzip code -- it seems to work, so we'll keep it for now.
- removed the (ugly) gray clock face from behind the spinning SOD "progress bar"
- moved makeSummaryStatsTable() from analyze.php to visualize.php
- moved to PHP 5.0.4 due to a printf() bug prior to 4.3.7
- wrote makeRemark42(), which was affected by said printf() bug
- wrote replacePdbRemark() to insert/update REMARK 42 records
- added interface for REMARK 42 in AAC/geom. pages
- fixed hless bug that threw NPEx when drawing 2SOD Rama outliers
- linked flipkins (if avail.) to Reduce notebook page
- removed "highlighted" kinemage view from downloads page
- added some extra version checking to check_config.php
- added res hiB to multichart for JSR
- made multicriterion chart sortable by storing as an encoded PHP array and
  writing public_html/viewtable.php to display it and sort it.
- updated analyze.php::runAnalysis() and aacgeom_setup.php for new multichart.
- added support for .table files in file_browser.php

### 3beta14 ###
- added "start" parameter to allow starting other places besides welcome page
- following bug has been fixed by update to Prekin 6.40.050310:
    Prekin: excess rota/rama outliers from too-long -range statement (?)
    test cases: 1FFY, 1XFH, 3AL1 (used to; doesn't any more)
- PdbStat now does chain identity as substring test rather than identity
- changed "AAC" to "All-atom contacts" (JSR); required changing minornav SPANs
  to DIVs in the navigation side bar. Safari still renders them correctly...
- changed viewer close button: When done [close this window]
- Multikin text: "Statistics for first FILE only..." becomes MODEL
- multikin: "mc/sc alts" to "mc/sc alt confs" and come up turned off
- NMR model splitter now puts model number first, not last (JSR)
- AAC/geom: "Output Formats" section now mentions extra plots/kins/lists (JSR)
- restored makeBfactorRibbons() function, though it's not in the multikin yet.
- fixed: Sort by Outliers moves hets to top (het chain = _) (1U4B)
- added gzip to list of required programs anticipating compression of lg. files
- created overview flowchart for interaction of different UIs with lib/*
- seriously reworked the multi-criterion kinemage for single-model mode
- changed colors, esp. Rama markers to thick, green, half-Ca bonds.
- changed rainbow ribbons back to B-factor ribbons for single models
- phi,psi output in multi-crit list now truncated to one decimal place
- put (some) summary stats at top of multichart
- put stats summary table at top, too
- factored summary stats table out of analyze.php:runAnalysis()
- fixed CBdev AWK script so master works for all subunits (test case: 2SOD)

### 3beta13 ###
- added check in index.php that a delegate page is actually specified
- simplified AAC/geom interface based on feedback from JSR
- made generation of B-ribbons, alt confs optional in multikin
- replaced B-ribbons with B- and Q-color scale renderings plus rainbow ribbons
- made summary stats optional
- color-coded summary stats results as good/fair/poor (traffic light)
- swapped positions of AAC/geom and SSWING icons on sitemap at Jane's request
- removed stand-alone 3-D Cbeta deviations kinemage b/c it appears in the multi
- implemented base-P outliers in multi kin, summary stats, multi-chart
- enabled sorting of multi-chart by baseP outliers
- updated Probe and Prekin (v050121) binaries for OS X, Linux
- added Welcome page (mostly without working links); made index.php start there.
- reorganized formatting of side links in lib/core.php
- added extra citation (NAR) to help/about
- report # H added/deleted/adjusted when running Reduce (build or nobuild)
- excess rota/rama multicrit outliers traced to Prekin (1FFY, 1XFH, 3AL1)
- changed preferred fonts to Arial and Optima
- created draft version of x-ray helper page
- can't catch back-button event to warn user not to...
- added color code for occupancy greater than 1.00
- turn on masters for alpha/beta/coil

### 3beta12 ###
- created command line scripts: reduce-build, reduce-nobuild, split-models
- explicit resolution range used for clashscore pct on analysis results page
- use "-nobuild" in descriptions even though it doesn't exist (yet)
- converted oneline-batch.php into oneline-analysis script for modifed sess structure
- changed model name finder to use underscore if model name ends in number
- sitemap now lists available models
- imported complex Probe runs (interface visualization) from MolProbity2
- actually moved MolProbity repository to new cluster
- enabled Probe commands for interface contacts
- split "Protein,DNA,RNA" selection into protein vs. nucleic acids
- added -DROP option for interface contacts
- fixed bug in describePdbStats() that never saw hydrogens
- modified cs-rank.awk to compare no-resol structures to entire c-score database
- made some navigation icons for sitemap; font is Helvetica Neue, 12pt, 75 Bold
- allowed makeEventForm() to accept a onSubmit cmd
- AAC page now warns about missing H only during form submit
- simplified JavaScripts on AAC page
- slightly changed wording, code for other no-H warnings
- replaced PHP_SELF with basename(PHP_SELF) b/c of kinemage-arachne URL rewrite
- added extra info to admin/check_config.php

### 3beta11 ###
- moved timezone setting to top of lab notebook page
- added noe-display to bin/
- removed public_html/job_progress.php, because it's been superceded.
- wrote document about the event/delegate model for the GUI
- added new "wait" graphic based on 2SOD (clock face)
- added count of mc/sc alternates in pdbstat
- added note about percentile ranking for clashscores in multi-output
- changed sc alts to cyan to complement the blue normal sc
- added @onewidth to multikins; turned stuff off/on with masters
- updated KiNG to support new on/off (point)masters
- finished doc on adding pages to MolProbity
- simple kins page works, but needs more detail (N--C color, etc)
- implemented HTML snapshots of lab notebook for later reference
- system now tracks "last used" model to give more continuity
- changed to high-penalty -build for "nobuild" Reduce runs
- simple kins page now makes sure there are actually models to act on
- AAC setup now syncs with pre-selected file on page load
- simple kins supports rainbow coloring and CPK atom markers
- reworked animated 2SOD "clock" graphic for job waits
- added more description to Site Map and linked to Feedback and bugs
- fixed subgroups in multicriterion kinemage
- added @onewidth to flipkin
- updated help pages to match site style sheet
- wrote "reduce-build" and "reduce-nobuild" command line scripts

### 3beta10 ###
- continued work on aac/geom analysis, rendering results as a notebook entry
- removed options for half-bond colors and atom-markers; this should be part
  of the simple kins. User can append later using URL filesystem!
- rewrote multi-crit kin function borrowing ideas from Jeremy's NMR kins
- not a bug: $_SESSION[hetdict] is used to set an environment var instead of directly
- added lib/models.php::splitModelNMR() based on JNB's code
- enabled upload and splitting of multiple NMR models
- fixed pdbstat() to not find "RESOLUTION. NOT APPLICABLE.  SEE REMARK 4."
  as a resolution of 4.0 A
- modified model splitter to REMARK out MODEL and ENDMDL lines
- improved reduce_choose page for case of no flips
- removed unneeded old pages from public_html (~r88)
- we now display comparison to run-of-PDB (SCOP 2000) for clash score
- added sortable multicriterion chart to aac/geom analysis page
  Sorting on the fly is complicated b/c of formatting issues. We could consider
  a page that lets you regenerate that chart to simulate dynamic sorting.
- fixed sorting bug for unset Rama, rota values appearing as zero
- did a little more work on check_config.php
- eliminated symlink-to-binary setup for pdbcns
- eliminated symlink-to-binary setup for other executables, except gawk on OS X
- removed unneeded statements from makelinks.sh
- renamed makelinks.sh to setup.sh
- updated reduce/prekin/probe on linux, os x
- updated linux SSWING binaries

### 3beta9 ###
- changed PDB upload back to stacked, rather than 2 column layout -- it's more
  consistent and visually cleaner. Fetch by ID is de-emphasized a bit, OK.
- added JavaMage thumbnail to notebook entry for PDB file upload/fetch.
- updated binaries for SSwing
- started building interface to SSWING again
- allow user to choose files with no H for SSWING, but warn them first w JScript
- finished SSwing interface, minus info about which sc really changed conf
- improved formatting/layout on Reduce's "choose" page
- added CSS rules for help text divs
- help text for setup pages is now grayed out; could change background instead.
- simplified sitemap.php by using onNavBarCall() instead of custom handlers.
- started AAC/geometry analysis UI; added JavaScript smarts to it
- finished JavaScript work in aacgeom_setup.php; got radios disabled
- JavaScript tested against several browsers, and all are fine:
  Mac: Safari 1.2.3; Mozilla 1.6; IE 5.2
  Linux: Mozilla 1.0.1, 1.2.1; Konqueror 2.2.2 (disable broken), 3.1-15
- added debug switch to sswing (-d); added debug output to sswing.php
- "Fast search" checkbox for sswing is now actually connected to something
- fixed setProgress() / getProgressTasks() bug (variable not marked global)
- added progress marker for making -cass kinemage during upload

### 3beta8 ###
- started work on the Reduce pathway; got the setup page done.
- swapped "Close" btn to left side of viewtext.php
- got reduce-build and reduce-nobuild jobs running, but no results page yet
- wrote save_kinemage.php that works with KiNG to allow user to save kins online
- changed reduce_setup so it's still possible to re-Reduce files with Hs
- added "choose" and "done" pages to Reduce cycle; still needs polishing
- I think the Reduce cycle is finally finished...
- started on feedback system
- removed -noadjust flag from Reduce -nobuild cmd lines; apparently causes
  problems with His protonation...
- refactored model-creation code into createModel()
- file upload now talks about PDB files, not "models"
- notebook can take bar-separated list of modelIDs instead of a single ID
- reduce-nobuild now generates a new model entry, and talks about file names
- fixed getVisitorIP() b/c $HTTP_* aren't registered by default anymore
- finished feedback pages
- broke upload pages into two parts
- added kinemage upload and viewing

### 3beta7 ###
- added forms for ED map and het dictionary upload
- moved session, errors, lifetime, labbook, progress to system/ folder.
- fixed admin/show_sessions.php to work with the new MVC/event model.
  (It didn't require changes for "session" moving. Yay for encapsulation!)
- removed dependency on event_page.php from sessions.php
  The MVC/event model should be a purely optional layer on top of the session
  functions; the session functions should be usable with the rest of it.
- made a really nice file view/download page with collapsible folders
- D&amp;J decided on a file-type-based folder system for organizing user files
- added logout handler and save-session handler
- updated the site map with download, logout, save session pages
- changed to MP_DIR_xxxx system for naming subdirectories, b/c Dave and Jane
  aren't sure what they want yet, and it will probably change later.
- file upload functions now group files into directories by file type
- KiNG viewing now looks in the (new) right place for electron density
- many things that used the old model data structure will be broken, b/c
  we've removed the per-model directories (and the corresponding URLs).

### 3beta6 ###
- created MVC/delegate architecture in public_thml/index.php
  and lib/event-page.php. See those files for documentation.
- added clearstatcache() to session read, just in case (ala lab notebook)
- created "site map" page based on the MVC/events model
- ported notebook view/edit pages to MVC/events model
- remodeled core.php:mpNavigationBar() to work with MVC/events
- added base class for all MVC/events delegate classes (works w/ nav bar)
*******************************************************************************
* NON-MVC MOLPROBITY3 IS NOW OFFICIALLY BROKEN. FURTHER WORK MUST USE MVC!    *
*******************************************************************************
- BUGFIX: mpSessReadOnly() did nothing b/c variable was not marked "global"
- background event launching has been converted to MVC/event system.
  This is untested thus far but appears to be working.
- removed lib/labbook.php:openWithEdit() because old pages are broken anyway.
- considered allowing return values and handlers for pageCall() / pageReturn()
  Ended up deciding against it -- see index.php for the complete argument.
- modified style sheet to get a more subtle look
- finished file upload (except for error handling)
- fixed 'abort' function in new job progress page
- got the fetch from PDB / NDB function working
- added upload error handling
- created initial pass on the site map's formatting
  
### 3beta5 ###
- traced mysterious labbook load/save bug from beta3 to missing clearstatcache()
- used that fixed bug to simplify improve_sswing_done.php; seems to still work
- running 1S72 (lg ribosomal subunit) requires ~40 min (?) and 450 Mb on arachne
- running 1S5L (photosystem II) on arachne takes 169 min and 62% of 200 Mb
  (that's without an AAC kin). The 102 Mb multicrit kin won't load in web KiNG.

### 3beta4 ###
- changed sswing runs to use idealPDB.pdb as the output, rather than stdout
  stdout formatting was not consistent enough to rely on
* Shuren tells me this is only a starting point for optimization. There is not
* yet any file that just contains the final sidechain conformation!
- no longer allow submission of SSWING form if no maps are present
- new models from PDB/NDB are now given lowercase names
  this plays better with the xxxH.pdb convention for Reduce naming
- added "preview" links to analysis run
- added session-overwrite safeguards to viewking.php for previewing use
- created infrastructure for setting a per-user het dictionary in $_SESSION
- created upload pages for custom het dictionary
- got modified SSWING from Shuren, now read result from sidechainPDB.pdb
- changed lib/analyze to make some quick kins first to keep user entertained

### 3beta3 ###
- reworked lab notebook functions to allow automagicical entries and editing
- added automatic notebook entry for file upload
- made Analyze to Reduce -build link go to the setup page instead of improve_tab
- improved the job_progress Abort function
- added framework code to support lab book in analyze_display
  some odd hacks were required to get the right behavior -- I'd love
  to find a more elegant way of doing something like this.
- notebook edit page now protects HTML special chars properly upon save
- analysis page now generates reasonable notebook entries
- added NAR reference to home_tab.php
- added automatic labbook entry for Reduce -build
- added automatic entry for SSWING, with more ugly hacks.

### 3beta2 ###
- added timing notes to SSWING setup page
- links now highlight on hover using CSS A:hover
- changed feedback code to use \r\n instead of \n for new lines.
  This eliminates the error message, but mail still doesn't get delivered?
- now caching user feedback on disk in addition to trying to send mail.
  Not elegant, but ensures nothing is lost.
  Feedback page now doesn't report failure except in the system log.
- changed CSS to remove border from link images (needed in Mozilla)
- fixed potential div-by-0 bug in analyze_display (lines 51,59,etc)
- added display of B lt 40 clashscore
- made some timing improvements in job_progress: slows down for long jobs
- feedback page now asks user to not delete files
- fixed bugs on notebook_edit and added note about using HTML tags
- added "Close" button to kin viewing page
- added controls to set size of KiNG window
- changed "Get input models" to the more accurate "Get input files"
- added CSS for syntax highlighting of kinemage files; updated king.jar
- added syntax highlighted view of kinemage files
- fixed a file-download annoyance: now files and dirs sort separately
- added file viewing links to download page; combined viewhtml and viewtext
- fixed addmodel.php (upload system) to rename files with "weird" names
- patched filesystem-access security hole in viewtext.php
- patched filesystem-overwrite security hole in ED Map Upload system
- fixed addModel() to protect from case-insensitive file systems like OS X
- removed segID remapping from reduceNoBuild() b/c it's not appropriate
- segID remapping is now done immediately on upload
- user is now warned if segID remapping occurred
- this avoids the bug from Top500/1aacH.pdb, which had its H in segment 'new '

### 3beta1 ###
- first beta release for testing inside the Richardson lab
- rotamers weren't showing up in multi-crit kin due to a stray "s" before -scope
  Thus the error msg "Prekin can't open s-scope". Probably due to jEdit save bug

### 3pre17 ###
- decided all logging calls should be from public_html/* pages b/c we want to
  know about web traffic, not about scripted use by local users.
- inserted logging calls on many public_html pages
- got basic SSWING function working! Yay!!
- added "X minutes and Y seconds" formatting to job update page
- made "download all files" always avail. from files page
- added ED map support to viewking.php
- added custom views to the SSWING kinemage
- SSWING now creates a new model for the changes to go into
- added basic dots to SSWING kins
- added link to EDS (still need auto map download)
- modified sswing (Perl) to delete all files it creates; we use stdout only.
- changed sidechain colors for SSWING kins
- made sure proper SSWING binaries are in place for both OS X and Linux
- user can now accept or reject changes made by SSWING

### 3pre16 ###
- cleaned up lab notebook formatting a bit. Still needs better styling.
- wrote text for log out and save session pages
- wrote text for Reduce setup page
- formatted Asn/Gln/His checkbox table with MP_XXX colors
- wrote some text for after you've run Reduce
- started working on Feedback system
- completed code for Feedback system, seems to work but needs live testing
- added B-vals in pt ID and blackbody colored B-factor ribbons to multi kin
- added explanatory text to analysis setup page
- hacked together a crude multi-criterion chart
- added electron density map upload
- improved the analysis results page to make it more usable.
- added PDBSTAT text to the multicrit text window
- added makeZipForSession() to core.php
- file download page can now package things into ZIPs
- started building in mechanisms for running SSWING
- Subversion repository got screwed again!!
- upgraded to svn 1.1.0-rc1 and rebuilt repos with "fsfs" filesystem
  (fresh checkout is not needed if new repos is loaded from dump of old one)
- added SSWING binaries and scripts

### 3pre15 ###
- elaborated oneline-batch to handle running Reduce -nobuild too
  Still needs some work to really be clean.
- added listDir() to core.php
- used listDir() to clean up the weird problems with oneline-batch.php -reduce
- got new Prekin, Reduce
- learned the hard way to not do Subversion work inside sym link directories.
  I could recover by doing dump/load and a clean checkout, but scary...
- got new Reduce, Prekin binaries for the Mac
- makelinks.sh now also creates molprobity.log and sets its permissions
- still seems to work on OS X (whew...)
- changed limit for Reduce to 100,000
- added notification of disk space used
- fixed coloring issue for download table
- added robot-exclustion META to header
- cleaned up home_tab for public viewing
- added ALERT divs to home_tab and improve_reduce_choose
- commented out non-functioning placeholders in upload_tab
- dropped Reduce -limit to 10,000 b/c now 1SBP flipkins take a LONG time
- background jobs now record their PID and user can abort them (POSIX only)
  
### 3pre14 ###
- refactored multicriterion kin creation into makeMulticritKin()
- created outlier-res-batch.php to do analysis for JNB
- we now use dirname(__FILE__) instead of getcwd() to define MP3 install dir
  This means e.g. that cmdline/ scripts can be run from any directory
- removed useless Cb dev statistics
- modified pdbstat regex's again for R/Rfree to catch data from TNT
- changed resolution regex to pick up on resolutions like "2." and ".54"
- changed fixH.pdb suffix to Hfix.pdb because its easier to get right
- modified clashlist to avoid the divide-by-zero error for no atoms B &lt; 40
- made the default Linux bin dir "linux/", symlinked it to linux-rh73/
- added Perl to the list of external programs (for Mike's scripts)
- removed defunct Cb stats from oneline-batch.php
- reworked decodeReduceUsermods() to deal with rare cases that we were failing on
- added a countflips.php command-line script to checking on what Reduce did

### 3pre13 ###
- created a tmp/ directory just for use by MolProbity (file uploads, ZIPs, etc)
- allowed user to pull files from PDB
- reworked pdbstat() to be slightly more efficient (still takes ~15 sec on 1JJ2)
- upload page can deal with failed PDB/NDB upload in a basic way
- download from NDB works but is slow...
- connection to NDB FTP server takes ~30 seconds -- this is why so slow!
- added refinement program and temperature, R and Rfree to pdbstats page
- removed defunct images and mockup HTML pages
- added configuration page for Reduce -build
- incorporated Flipkin creation into the first Reduce step
- started porting the second, user-guided Reduce step
- finished the mechanics of porting the second Reduce step, now just UI tweaking
- updated the documentation on files created per model, and reorganized the sections
- added B-factor ribbons back to the multi-criteria kinemage
- made it so that second Reduce run is entirely skipped if no changes are requested
- marked models that have been through Reduce -build once; makes no sense to run them again!
- replaced progress bar image with a spinning ubiquitin ribbon drawing
- developed oneline-batch.php to extract basic quality stats from a folder of Reduced PDBs
- added calcCbetaStats() to find min, max, mode, mean, stddev
- improved REMARK regex's in pdbstat.php
- oops! I was calling the median "mode" in the above calcCbetaStats().
- code for tallying Rama outliers kept a running tally over all models (var not reset)
- Reduce 2.21 on Linux introduced line noise into some USER MODS, including ASCII 26 (hex 1a).
  Scrublines was set to terminate on this character, so I changed that and recompiled.
  This was previously causing affected PDBs to be truncated upon upload.
- improved regex's for R and Rfree to specify leading zero or decimal point
- changed loadClashlist() to guard against no clashes (and no summary!) for scores

### 3pre12 ###
- updated program requirements to list "zip"
- changed style sheet to sans-serif fonts, turned off link underlines
- changed color and upped contrast slightly on the logo
- added more elaborate flow chart
- created dummy pages for compare and improve
- created page to describe contents of uploaded file
- added Ramalyze PDF to analysis script
- swapped file upload and PDB-pull panes on upload page
- mc-mc dots in multicrit kin were actually all dots
- added reduceBuild() function to model.php
- implemented removeModel() and tested it from the command line scripts
- created a disk-too-full die() in mpInitEnvirons()
- added endsWith() to strings.php
- added system logging function. Individual user logging is of little use
  and will be effectively replaced by automated lab notebook entries.
- implemented a progress bar and list of tasks for analysis script
- did the same for addmodel and reduce-build jobs

### 3pre11 ###
- updated PDB stat to find nonpolar H in nucleic acids, too.
- updated pdbstat to find nucleic acid residues
- changed preparePDB() to not add H; now done by reduceNoBuild()
- renamed prepared() upload PDB so as not to confuse user
- reworked analysis scripts so that only selected jobs are performed
- reworked analysis so that hydrogens are added "just in time" if needed
- put both mc-mc and sc-(anything) dots in AAC kinemage, but separately
- removed Ramachandran JPEG and EPS files in anticipation of providing PDFs
- removed Mage as a necessary binary
- modified multicriterion kin to separate mc-mc and sc-x dots
- replaced findOutliers() with 4 separate functions
- analysis display page now adapts to the presence / absence of various criteria
- refactored jobs/addmodel.php into lib/model.php:addModel()
- refactored jobs/analyze.php into lib/analyze.php:runAnalysis()
- created a proof-of-concept cmd-line-driven script to use MP functions
- added machinery to create a ZIP archive of all a model's files

### 3pre10 ###
- really reworked page header/footer/styling. Style sheet hasn't been finished yet.
- removed all tab bar images and templates
- came up with a pretty decent "look" for the site; may change colors to match kinemage site
- rearranged upload page
- allowed user to revisit previously generated analysis
- each model now has its own download URL too
- implemented function to generate kinemage-viewing links
- added embedded KiNG page for kinemage viewing
- tried a pale brown background theme
- fixed accidentally introduced bug in analyze_display.php
- made nicer display of multi crit kinemage
- added Ramachandran plots to output of analysis (jpeg, kin, eps)
- added CB dev, all-atom contacts to analysis output

### 3pre9 ###
- added 'ignoreSegID' option to handle old Reduce'd files with 'new' in segID field
- loadRamachandran() and loadRotamer() now decompose residue names into parts
- loadCbetaDev() now synthesizes a residue name from the parts
- loadClashlist() now picks up worst clash per residue
- badRes now markes residues with clashes >= 0.40 A
- refactored badRes code into lib/analysis.php:findOutliers()
- started lib/visualize.php to make data visualizations
- wrote functions to find res with alt confs and guess at res center in 3-space
- started working on the new MultiCrit

### 3pre8 ###
- brought the whole project under Subversion version control
- created a shell script to restore filesystem state (symlinks and permissions)
- created analyze_display.php for Jeremy to start working in
- fixed loadCbetaDev() to deal with multiple headers from Prekin
- created a basic file-listing page
- administrator can now "enter" sessions from the monitoring page
- mocked up some HTML layouts for pages
- check script now tells about how big file uploads can be
- added "last touched" to admin page
- moved all string and formating functions to strings.php
- set svn:ignore properties on public_html/ and on symlinks in bin/
- check for presence of models before trying to list them.
  Alternately, we could just define $_SESSION['models'] = array() at startup.
  Actually, lets do that too.

### 3pre7 ###
- filled in the PDB upload form, though it doesn't do anything yet.
- implemented first cases of "More/Fewer options" links
- implemented background execution via launchBackground()
- implemented background job monitoring via job_progress.php
- file upload now works, basically, though no processing is performed.
- added config parameter MP_DEFAULT_TIMEZONE
- worked out a bug in launchBackground(): session data wasn't written immediately
- addmodel.php now does some nice pre-processing of all new models uploaded
- pdbstat now reports refinement program and temp, and a count of CNS headers
- refactored jobs/addmodel.php to facilitate future offline scripts
- created a function to write session data to disk immediately
- reworked the definition of a model entry.
  Now using -build will create a new model, so you can compare to the old.
- did proof-of-concept for Cbeta deviation analysis and clashlist

### 3pre6 ###
- filled in the Finish tab (rough draft) to allow users to log out
- described what should go in each tab

### 3pre5 ###
- fixed bug in GC function
- made PATH in config.php depend on MP_BASE_DIR
- added some things to check_config.php
- PATH setup is smarter: auto-detects OS and adds our bin/ directory
- added read-only marker for sessions to enable D&J's partial results
- it might make sense to make labbook keywords an array, but then
  transmitting them in a form becomes harder.
- started working on a standard page header
- Experimented with tables, images to make tabs. Images are a better bet.
- made first drafts of all the tab pages (empty). Linked them together.
- made labbook page work pretty well

### 3pre4 ###
- refined sessions yet again: now each top level page must know where
  the base installation directory is, relative to itself.
- session support has been reworked to use MP_BASE_DIR
- session create now defaults to false. This limits points of entry.
- added marker file for session lifetime
- added administrator overview of current sessions
- created garbage collection functions

### 3pre3 ###
- added (optional) mode to mkdir() call in sessions.php
- added time zone support to lab notebook
- continued refining session code

### 3pre2 ###
- wrote the which() part of check_config.php
- configured sessions to never use cookies
- implemented bare-bones of a lab notebook system
- rearranged how the include() system is set up

### 3pre1 ###
- built custom session-handling functions
- established simple test case for running background jobs
- started documentation

</pre></body></html>